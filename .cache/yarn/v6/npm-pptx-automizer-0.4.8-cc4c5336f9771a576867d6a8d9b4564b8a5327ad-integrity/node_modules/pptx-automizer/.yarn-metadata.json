{
  "manifest": {
    "name": "pptx-automizer",
    "version": "0.4.8",
    "description": "A template based pptx generator",
    "repository": {
      "type": "git",
      "url": "git+https://github.com/singerla/pptx-automizer.git"
    },
    "author": {
      "name": "Thomas Singer",
      "email": "tsinger@gmx.de",
      "url": "github.com/singerla"
    },
    "license": "MIT",
    "private": false,
    "scripts": {
      "build": "tsc",
      "dev": "nodemon -e ts --exec 'ts-node' src/dev.ts",
      "test": "npx jest",
      "test-coverage": "npx jest --coverage",
      "lint": "eslint '*/**/*.{js,ts,tsx}' --fix",
      "prettier": "prettier --config .prettierrc 'src/**/*.ts' --write"
    },
    "files": [
      "dist",
      "README"
    ],
    "main": "dist/index.js",
    "types": "dist/index.d.js",
    "keywords": [
      "js-create-powerpoint",
      "js-create-pptx",
      "js-generate-powerpoint",
      "js-pptx",
      "js-produce-powerpoint",
      "js-powerpoint",
      "powerpoint",
      "powerpoint-charts",
      "powerpoint-presentation",
      "powerpoint-automation",
      "powerpoint-generator",
      "pptx",
      "presentations"
    ],
    "devDependencies": {
      "@types/jest": "^29.4.0",
      "@types/node": "^18.11.18",
      "@types/xmldom": "^0.1.30",
      "@typescript-eslint/eslint-plugin": "^5.49.0",
      "@typescript-eslint/parser": "^5.49.0",
      "eslint": "^8.32.0",
      "eslint-config-prettier": "^8.6.0",
      "eslint-plugin-prettier": "^4.2.1",
      "jest": "^29.4.0",
      "nodemon": "^2.0.20",
      "prettier": "^2.8.3",
      "ts-jest": "^29.0.5",
      "ts-node": "^10.9.1",
      "typedoc": "^0.23.24",
      "typescript": "^4.9.4"
    },
    "dependencies": {
      "@xmldom/xmldom": "^0.8.6",
      "extract-zip": "^2.0.1",
      "jszip": "^3.10.1",
      "regexp.escape": "^1.1.0"
    },
    "_registry": "npm",
    "_loc": "/home/dpcsdev/.cache/yarn/v6/npm-pptx-automizer-0.4.8-cc4c5336f9771a576867d6a8d9b4564b8a5327ad-integrity/node_modules/pptx-automizer/package.json",
    "readmeFilename": "README.md",
    "readme": "# pptx-automizer: A Powerful .pptx Modifier for Node.js\n\n`pptx-automizer` is a Node.js-based PowerPoint (.pptx) generator that automates the manipulation of existing .pptx files. With `pptx-automizer`, you can import your library of .pptx templates, merge templates, and customize slide content. `pptx-automizer` will not write files from scratch, but edit and merge existing pptx files. You can style template slides within PowerPoint, and these templates will be seamlessly integrated into the output presentation. Most of the content can be modified by using callbacks with [xmldom](https://github.com/xmldom/xmldom).\n\n`pptx-automizer` is particularly well-suited for users who aim to manage their own library of .pptx template files, making it an ideal choice for those who work with intricate, well-designed customized layouts. With this tool, any existing slide or even a single element can serve as a data-driven template for generating output .pptx files.\n\nThis project is accompanied by [automizer-data](https://github.com/singerla/automizer-data). You can use `automizer-data` to import, browse and transform .xlsx- or .sav-data into perfectly fitting graph or table data.\n\nThanks to all contributors! You are always welcome to share code, tipps and ideas. We appreciate all levels of expertise and encourage everyone to get involved. Whether you're a seasoned pro or just starting out, your contributions are invaluable. [Get started](https://github.com/singerla/pptx-automizer/issues/new)\n\nIf you require commercial support for complex .pptx automation, you can explore [ensemblio.com](https://ensemblio.com). Ensemblio is a web application that leverages `pptx-automizer` and `automizer-data` to provide an accessible and convenient solution for automating .pptx files. Engaging with Ensemblio is likely to enhance and further develop this library.\n\n## Table of contents\n\n<!-- TOC -->\n\n- [Requirements and Limitations](#requirements-and-limitations)\n  - [Shape Types](#shape-types)\n  - [Chart Types](#chart-types)\n  - [Animations](#animations)\n  - [Slide Masters and -Layouts](#slide-masters-and--layouts)\n  - [Direct Manipulation of Elements](#direct-manipulation-of-elements)\n  - [PowerPoint Version](#powerpoint-version)\n- [Installation](#installation)\n  - [As a Cloned Repository](#as-a-cloned-repository)\n  - [As a Package](#as-a-package)\n- [Usage](#usage)\n  - [Basic Example](#basic-example)\n  - [How to Select Slides Shapes](#how-to-select-slides-shapes)\n    - [Select slide by number and shape by name](#select-slide-by-number-and-shape-by-name)\n    - [Select slides by creationId](#select-slides-by-creationid)\n  - [Find and Modify Shapes](#find-and-modify-shapes)\n  - [Modify Text](#modify-text)\n  - [Modify Images](#modify-images)\n  - [Modify Tables](#modify-tables)\n  - [Modify Charts](#modify-charts)\n  - [Modify Extended Charts](#modify-extended-charts)\n  - [Remove elements from a slide](#remove-elements-from-a-slide)\n- [Tipps and Tricks](#tipps-and-tricks)\n  - [Loop through the slides of a presentation](#loop-through-the-slides-of-a-presentation)\n  - [Quickly get all slide numbers of a template](#quickly-get-all-slide-numbers-of-a-template)\n  - [Find all text elements on a slide](#find-all-text-elements-on-a-slide)\n  - [Sort output slides](#sort-output-slides)\n  - [Import and modify slide Masters](#import-and-modify-slide-masters)\n  - [Track status of automation process](#track-status-of-automation-process)\n  - [More examples](#more-examples)\n  - [Create a new modifier](#create-a-new-modifier)\n  - [Troubleshooting](#troubleshooting)\n  - [Testing](#testing)\n- [Special Thanks](#special-thanks)\n<!-- TOC -->\n\n# Requirements and Limitations\n\nThis generator can only be used on the server-side and requires a [Node.js](https://nodejs.org/en/download/package-manager/) environment.\n\n## Shape Types\n\nAt the moment, you might encounter difficulties with special shape types that require additional relations (e.g., hyperlinks, video and audio may not work correctly). However, most shape types, including connection shapes, tables, and charts, are already supported. If you encounter any issues, please feel free to [report any issue](https://github.com/singerla/pptx-automizer/issues/new).\n\n## Chart Types\n\nExtended chart types, like waterfall or map charts, are basically supported. You might need additional modifiers to handle extended properties, which are not implemented yet. Please help to improve `pptx-automizer` and [report](https://github.com/singerla/pptx-automizer/issues/new) issues regarding extended charts.\n\n## Animations\n\nAnimations are currently out of scope of this library. You might get errors on opening an output .pptx when there are added or removed shapes. This is because `pptx-automizer` doesn't synchronize `id`-attributes of animations with the existing shapes on a slide.\n\n## Slide Masters and -Layouts\n\n`pptx-automizer` supports importing slide masters and their associated slide layouts into the output presentation. It is important to note that you cannot add, modify, or remove individual slideLayouts directly. However, you have the flexibility to modify the underlying slideMaster, which can serve as a workaround for certain changes.\n\nPlease be aware that importing slideLayouts containing complex contents, such as charts and images, is currently not supported. For instance, if a slideLayout includes an icon that is not present on the slideMaster, this icon will break when the slideMaster is auto-imported into an output presentation. To avoid this issue, ensure that all images and charts are placed exclusively on a slideMaster and not on a slideLayout.\n\n## Direct Manipulation of Elements\n\nIt is also important to know that `pptx-automizer` is currently limited to _adding_ things to the output presentation. If you require the ability to, for instance, modify a specific element on a slide within an existing presentation and leave the rest untouched, you will need to include all the other slides in the process. Find some workarounds [below](#loop-through-the-slides-of-a-presentation).\n\n## PowerPoint Version\n\nAll testing focuses on PowerPoint 2019 .pptx file format.\n\n# Installation\n\nThere are basically two ways to use `pptx-automizer`.\n\n## As a Cloned Repository\n\nIf you want to see how it works and you like to run own tests, you should clone this repository and install the dependencies:\n\n```\n$ git clone git@github.com:singerla/pptx-automizer.git\n$ cd pptx-automizer\n$ yarn install\n```\n\nYou can now run\n\n```\n$ yarn dev\n```\n\nand see the most recent feature from `src/dev.ts`. Every time you change & save this file, you will see new console output and a pptx file in the destination folder. Take a look into `__tests__`-directory to see a lot of examples for several use cases!\n\n## As a Package\n\nIf you are working on an existing project, you can add `pptx-automizer` to it using npm or yarn. Run\n\n```\n$ yarn add pptx-automizer\n```\n\nor\n\n```\n$ npm install pptx-automizer\n```\n\nin the root folder of your project. This will download and install the most recent version into your existing project.\n\n# Usage\n\nTake a look into [**tests**-directory](https://github.com/singerla/pptx-automizer/blob/main/__tests__) to see a lot of examples for several use cases. You will also find example .pptx-files there. Most of the examples shown below make use of [those files](https://github.com/singerla/pptx-automizer/blob/main/__tests__/pptx-templates).\n\n## Basic Example\n\nThis is a basic example on how to use `pptx-automizer` in your code:\n\n```ts\nimport Automizer from 'pptx-automizer';\n\n// First, let's set some preferences!\nconst automizer = new Automizer({\n  // this is where your template pptx files are coming from:\n  templateDir: `my/pptx/templates`,\n\n  // use a fallback directory for e.g. generic templates:\n  templateFallbackDir: `my/pptx/fallback-templates`,\n\n  // specify the directory to write your final pptx output files:\n  outputDir: `my/pptx/output`,\n\n  // turn this to true if you want to generally use\n  // Powerpoint's creationIds instead of slide numbers\n  // or shape names:\n  useCreationIds: false,\n\n  // Always use the original slideMaster and slideLayout of any\n  // imported slide:\n  autoImportSlideMasters: true,\n\n  // truncate root presentation and start with zero slides\n  removeExistingSlides: true,\n\n  // activate `cleanup` to eventually remove unused files:\n  cleanup: false,\n\n  // Set a value from 0-9 to specify the zip-compression level.\n  // The lower the number, the faster your output file will be ready.\n  // Higher compression levels produce smaller files.\n  compression: 0,\n\n  // You can enable 'archiveType' and set mode: 'fs'.\n  // This will extract all templates and output to disk.\n  // It will not improve performance, but it can help debugging:\n  // You don't have to manually extract pptx contents, which can\n  // be annoying if you need to look inside your files.\n  // archiveType: {\n  //   mode: 'fs',\n  //   baseDir: `${__dirname}/../__tests__/pptx-cache`,\n  //   workDir: 'tmpWorkDir',\n  //   cleanupWorkDir: true,\n  // },\n\n  // use a callback function to track pptx generation process.\n  // statusTracker: myStatusTracker,\n});\n\n// Now we can start and load a pptx template.\n// With removeExistingSlides set to 'false', each addSlide will append to\n// any existing slide in RootTemplate.pptx. Otherwise, we are going to start\n// with a truncated root template.\nlet pres = automizer\n  .loadRoot('RootTemplate.pptx')\n  // We want to make some more files available and give them a handy label.\n  .load('SlideWithShapes.pptx', 'shapes')\n  .load('SlideWithGraph.pptx', 'graph')\n  // Skipping the second argument will not set a label.\n  .load('SlideWithImages.pptx');\n\n// Get useful information about loaded templates:\n/*\nconst presInfo = await pres.getInfo();\nconst mySlides = presInfo.slidesByTemplate('shapes');\nconst mySlide = presInfo.slideByNumber('shapes', 2);\nconst myShape = presInfo.elementByName('shapes', 2, 'Cloud');\n*/\n\n// addSlide takes two arguments: The first will specify the source\n// presentation's label to get the template from, the second will set the\n// slide number to require.\npres\n  .addSlide('graph', 1)\n  .addSlide('shapes', 1)\n  .addSlide('SlideWithImages.pptx', 2);\n\n// Finally, we want to write the output file.\npres.write('myPresentation.pptx').then((summary) => {\n  console.log(summary);\n});\n\n// It is also possible to get a ReadableStream.\n// stream() accepts JSZip.JSZipGeneratorOptions for 'nodebuffer' type.\nconst stream = await pres.stream({\n  compressionOptions: {\n    level: 9,\n  },\n});\n// You can e.g. output the pptx archive to stdout instead of writing a file:\nstream.pipe(process.stdout);\n\n// If you need any other output format, you can eventually access\n// the underlying JSZip instance:\nconst finalJSZip = await pres.getJSZip();\n// Convert the output to whatever needed:\nconst base64 = await finalJSZip.generateAsync({ type: 'base64' });\n```\n\n## How to Select Slides Shapes\n\n`pptx-automizer` needs a selector to find the required shape on a template slide. While an imported .pptx file is identified by filename or custom label, there are different ways to address its slides and shapes.\n\n### Select slide by number and shape by name\n\nIf your .pptx-templates are more or less static and you do not expect them to evolve a lot, it's ok to use the slide number and the shape name to find the proper source of automation.\n\n```ts\n// This will take slide #2 from 'SlideWithGraph.pptx' and expect it\n// to contain a shape called 'ColumnChart':\npres.addSlide('SlideWithGraph.pptx', 2, (slide) => {\n  // `slide` is slide #2 of 'SlideWithGraph.pptx'\n  slide.modifyElement('ColumnChart', [\n    /* ... */\n  ]);\n});\n\n// This example will take slide #1 from 'RootTemplate.pptx' and place\n// 'ColumnChart' from slide #2 of 'SlideWithGraph.pptx' on it.\npres.addSlide('RootTemplate.pptx', 1, (slide) => {\n  // `slide` is slide #1 of 'RootTemplate.pptx'\n  slide.addElement('SlideWithGraph.pptx', 2, 'ColumnChart', [\n    /* ... */\n  ]);\n});\n```\n\n> You can display and manage shape names directly in PowerPoint by opening the \"Selection\"-pane for your current slide. Hit `ALT+F10` and PowerPoint will give you a (nested) list including all (grouped) shapes. You can edit a shape name by double-click or by hitting `F2` after selecting a shape from the list. [See MS-docs for more info.](https://support.microsoft.com/en-us/office/use-the-selection-pane-to-manage-objects-in-documents-a6b2fd3e-d769-46c1-9b9c-b94e04a72550)\n\nBut be aware: Whenever your template slides are rearranged or a template shape is renamed, you need to update your code as well.\n\nPlease also make sure that each shape to add or modify has a unique name on its slide. Otherwise, only the last matching shape will be taken as target.\n\n### Select slides by creationId\n\nAdditionally, each slide and shape is stored together with a (more or less) unique `creationId`. In XML, it looks like this:\n\n```xml\n<p:cNvPr name=\"MyPicture\" id=\"64\">\n    <a:extLst>\n        <a:ext uri=\"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}\">\n            <a16:creationId id=\"{0980FF19-E7E7-493C-8D3E-15B2100EA940}\" xmlns:a16=\"http://schemas.microsoft.com/office/drawing/2014/main\"/>\n        </a:ext>\n    </a:extLst>\n</p:cNvPr>\n```\n\nThis is where `name` and `creationId` are coupled together for each shape.\n\nWhile our shape could now be identified by both, `MyPicture` or by `{0980FF19-E7E7-493C-8D3E-15B2100EA940}`, `creationIds` for slides consist of an integer value, e.g. `501735012` below:\n\n```xml\n<p:extLst>\n   <p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\">\n      <p14:creationId val=\"501735012\" xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\"/>\n   </p:ext>\n</p:extLst>\n```\n\nYou can add a simple code snippet to get a list of the available `creationIds` of your loaded templates:\n\n```ts\nconst pres = automizer\n  .loadRoot(`RootTemplate.pptx`)\n  .load(`SlideWithShapes.pptx`, 'shapes');\n\nconst creationIds = await pres.setCreationIds();\n\n// This is going to print the slide creationId and a list of all\n// shapes from slide #1 in `SlideWithShapes.pptx` (aka `shapes`).\nconsole.log(\n  creationIds\n    .find((template) => template.name === 'shapes')\n    .slides.find((slide) => slide.number === 1),\n);\n// Find the corresponding slide-creationId and -number on top of this list.\n```\n\nIf your templates are not final and if you expect to have new slides and shapes added in the future, it is worth the effort and use `creationId` in general:\n\n```ts\nconst automizer = new Automizer({\n  templateDir: `${__dirname}/pptx-templates`,\n  outputDir: `${__dirname}/pptx-output`,\n  // turn this to true and use creationIds for both, slides and shapes\n  useCreationIds: true,\n});\n```\n\nRegarding shapes, it is also possible to use a `creationId` and the shape name as a fallback. These are the different types of a `FindElementSelector`:\n\n```ts\nimport { FindElementSelector } from './types/types';\n\n// This is default when set up with `useCreationIds: true`:\nconst myShapeSelectorCreationId: FindElementSelector =\n  '{E43D12C3-AD5A-4317-BC00-FDED287C0BE8}';\n\n// pptx-generator will try to find the shape even if one of the given keys\n// won't match any shape on the target slide:\nconst myShapeSelectorFallback: FindElementSelector = {\n  creationId: '{E43D12C3-AD5A-4317-BC00-FDED287C0BE8}',\n  name: 'Drum',\n};\n\n// Use this only if `useCreationIds: false`:\nconst myShapeSelectorName: FindElementSelector = 'Drum';\n\n// Whenever `useCreationIds` was set to true, you need to replace slide numbers\n// by `creationId`, too:\nawait pres.addSlide('shapes', 4167997312, (slide) => {\n  // slide is now #1 of `SlideWithShapes.pptx`\n  slide.addElement('shapes', 273148976, {\n    creationId: '{E43D12C3-AD5A-4317-BC00-FDED287C0BE8}',\n    name: 'Drum',\n  });\n  // 'Drum' is from #2 of `SlideWithShapes.pptx`, see __tests__ dir for an\n  // example.\n});\n```\n\nIf you decide to use the `creationId` method, you are safe to add, remove and rearrange slides in your templates. It is also no problem to update shape names, and you also don't need to pay attention to unique shape names per slide.\n\n> Please note: PowerPoint is going to update a shape's `creationId` only in case the shape was copied & pasted on a slide with an already existing identical shape `creationId`. If you were copying a slide, each shape `creationId` will be copied, too. As a result, you have unique shape ids, but different slide `creationIds`. If you are now going to paste a shape an such a slide, a new creationId will be given to the pasted shape. As a result, slide ids are unique throughout a presentation, but shape ids are unique only on one slide.\n\n## Find and Modify Shapes\n\nThere are basically to ways to access a target shape on a slide:\n\n- `slide.modifyElement(...)` requires an existing shape on the current slide,\n- `slide.addElement(...)` adds a shape from another slide to the current slide.\n\nModifications can be applied to both in the same way:\n\n```ts\nimport { modify, CmToDxa } from 'pptx-automizer';\n\npres.addSlide('shapes', 2, (slide) => {\n  // This will only work if there is a shape called 'Drum'\n  // on slide #2 of the template labelled 'shapes'.\n  slide.modifyElement('Drum', [\n    // You can use some of the builtin modifiers to edit a shape's xml:\n    modify.setPosition({\n      // set position from the left to 5 cm\n      x: CmToDxa(5),\n      // or use a number in DXA unit\n      h: 5000000,\n      w: 5000000,\n    }),\n    // Log your target xml into the console:\n    modify.dump,\n  ]);\n});\n\npres.addSlide('shapes', 1, (slide) => {\n  // This will import the 'Drum' shape from\n  // slide #2 of the template labelled 'shapes'.\n  slide.addElement('shapes', 2, 'Drum', [\n    // add modifiers as seen in the example above\n  ]);\n});\n```\n\n## Modify Text\n\nYou can select and import generic shapes from any loaded template. It is possible to update the containing text in several ways:\n\n```ts\nimport { ModifyTextHelper } from 'pptx-automizer';\n\npres.addSlide('SlideWithImages.pptx', 1, (slide) => {\n  // You can directly modify the child nodes of <p:sp>\n  slide.addElement('shapes', 2, 'Arrow', (element) => {\n    element.getElementsByTagName('a:t').item(0).firstChild.data =\n      'Custom content';\n  });\n\n  // You might prefer a built-in function to set text:\n  slide.addElement('shapes', 2, 'Arrow', [\n    ModifyTextHelper.setText('This is my text'),\n  ]);\n});\n```\n\n`pptx-automizer` also provides a powerful helper to replace tagged text. You can use e.g. `{{myTag}}` on your slide and apply a modifier to insert dynamic text. Font style can be inherited from template or updated by the modifier.\n\n```ts\nimport { modify } from 'pptx-automizer';\n\npres.addSlide('TextReplace.pptx', 1, (slide) => {\n  slide.modifyElement(\n    // This is the name of the target element on slide #1 of\n    // 'TextReplace.pptx\n    'replaceText',\n    // This will look for a string `{{replace}}` inside the text\n    // contents of 'replaceText' shape\n    modify.replaceText([\n      {\n        replace: 'replace',\n        by: {\n          text: 'Apples',\n        },\n      },\n    ]),\n  );\n});\n```\n\nFind out more about text replacement:\n\n- [Replace and style by tags](https://github.com/singerla/pptx-automizer/blob/main/__tests__/replace-tagged-text.test.ts)\n- [Modify text elements using getAllTextElementIds](https://github.com/singerla/pptx-automizer/blob/main/__tests__/get-all-text-element-ids.test.ts)\n\n## Modify Images\n\n`pptx-automizer` can extract images from loaded .pptx template files and add to your output presentation. You can use shape modifiers (e.g. for size and position) on images, too. Additionally, it is possible to load external media files directly and update relation `Target` of an existing image. This works on both, existing or added images.\n\n```ts\nconst automizer = new Automizer({\n  // ...\n  // Specify a directory to import external media files from:\n  mediaDir: `path/to/media`,\n});\n\nconst pres = automizer\n  .loadRoot(`RootTemplate.pptx`)\n  // load one or more files from mediaDir\n  .loadMedia([`feather.png`, `test.png`] /* or use a custom dir */)\n  // and/or use a custom dir\n  .loadMedia(`icon.png`, 'path/to/icons')\n  .load(`SlideWithImages.pptx`, 'images');\n\npres.addSlide('images', 2, (slide) => {\n  slide.modifyElement('imagePNG', [\n    // Override the original media source of element 'imagePNG'\n    // by an imported file:\n    ModifyImageHelper.setRelationTarget('feather.png'),\n\n    // You might need to update size\n    ModifyShapeHelper.setPosition({\n      w: CmToDxa(5),\n      h: CmToDxa(3),\n    }),\n  ]);\n});\n```\n\nFind more examples on image manipulation:\n\n- [Add external image](https://github.com/singerla/pptx-automizer/blob/main/__tests__/add-external-image.test.ts)\n- [Modify duotone color overlay for images](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-image-duotone.test.ts)\n- [Swap image source on a slide master](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-master-external-image.test.ts)\n\n## Modify Tables\n\nYou can use a PowerPoint table and add/modify data and style. It is also possible to add rows and columns and to style cells.\n\n```ts\nconst pres = automizer\n  .loadRoot(`RootTemplate.pptx`)\n  .load(`SlideWithTables.pptx`, 'tables');\n\nconst result = await pres.addSlide('tables', 3, (slide) => {\n  slide.modifyElement('TableWithEmptyCells', [\n    modify.setTable({\n      // Use an array of rows to insert data.\n      // use `label` key for your information only\n      body: [\n        { label: 'item test r1', values: ['test1', 10, 16, 12, 11] },\n        { label: 'item test r2', values: ['test2', 12, 18, 15, 12] },\n        { label: 'item test r3', values: ['test3', 14, 12, 11, 14] },\n      ],\n    }),\n  ]);\n});\n```\n\nFind out more about formatting cells:\n\n- [Modify and style table cells](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-existing-table.test.ts)\n- [Insert data into table with empty cells](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-existing-table-create-text.test.ts)\n\n## Modify Charts\n\nAll data and styles of a chart can be modified. Please note that if your template contains more data than your data object, Automizer will remove these extra nodes. Conversely, if you provide more data, new nodes will be cloned from the first existing one in the template.\n\n```ts\n// Modify an existing chart on an added slide.\npres.addSlide('charts', 2, (slide) => {\n  slide.modifyElement('ColumnChart', [\n    // Use an object like this to inject the new chart data.\n    // Additional series and categories will be copied from\n    // previous sibling.\n    modify.setChartData({\n      series: [\n        { label: 'series 1' },\n        { label: 'series 2' },\n        { label: 'series 3' },\n      ],\n      categories: [\n        { label: 'cat 2-1', values: [50, 50, 20] },\n        { label: 'cat 2-2', values: [14, 50, 20] },\n        { label: 'cat 2-3', values: [15, 50, 20] },\n        { label: 'cat 2-4', values: [26, 50, 20] },\n      ],\n    }),\n  ]);\n});\n```\n\nFind out more about modifying charts:\n\n- [Modify chart axis](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-axis.test.ts)\n- [Dealing with bubble charts](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-bubbles.test.ts)\n- [Vertical line charts](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-vertical-lines.test.ts)\n- [Style chart series and data points](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-existing-chart-styled.test.ts)\n\n## Modify Extended Charts\n\nIf you need to modify extended chart types, such like waterfall or map charts, you need to use `modify.setExtendedChartData`.\n\n```ts\n// Add and modify a waterfall chart on slide.\npres.addSlide('charts', 2, (slide) => {\n  slide.addElement('ChartWaterfall.pptx', 1, 'Waterfall 1', [\n    modify.setExtendedChartData(<ChartData>{\n      series: [{ label: 'series 1' }],\n      categories: [\n        { label: 'cat 2-1', values: [100] },\n        { label: 'cat 2-3', values: [50] },\n        { label: 'cat 2-4', values: [-40] },\n        // ...\n      ],\n    }),\n  ]);\n});\n```\n\n## Remove elements from a slide\n\nYou can as well remove elements from slides.\n\n```ts\n// Remove existing charts, images or shapes from added slide.\npres\n  .addSlide('charts', 2, (slide) => {\n    slide.removeElement('ColumnChart');\n  })\n  .addSlide('images', 2, (slide) => {\n    slide.removeElement('imageJPG');\n    slide.removeElement('Textfeld 5');\n    slide.addElement('images', 2, 'imageJPG');\n  });\n```\n\n# Tipps and Tricks\n\n## Loop through the slides of a presentation\n\nIf you would like to modify elements in a single .pptx file, it is important to know that `pptx-automizer` is not able to directly \"jump\" to a shape to modify it.\n\nThis is how it works internally:\n\n- Load a root template to append slides to it\n- (Probably) load root template again to modify slides\n- Load other templates\n- Append a loaded slide to (probably truncated) root template\n- Modify the recently added slide\n- Write root template and appended slides as output presentation.\n\nIn case you need to apply modifications to the root template, you need to load it as a normal template:\n\n```ts\nimport Automizer, {\n  CmToDxa,\n  ISlide,\n  ModifyColorHelper,\n  ModifyShapeHelper,\n  ModifyTextHelper,\n} from 'pptx-automizer';\n\nconst run = async () => {\n  const automizer = new Automizer({\n    templateDir: `path/to/pptx-templates`,\n    outputDir: `path/to/pptx-output`,\n    // this is required to start with no slides:\n    removeExistingSlides: true,\n  });\n\n  let pres = automizer\n    .loadRoot(`SlideWithShapes.pptx`)\n    // We load it twice to make it available for modifying slides.\n    // Defining a \"name\" as second params makes it a little easier\n    .load(`SlideWithShapes.pptx`, 'myTemplate');\n\n  // Get useful information about loaded templates:\n  const myTemplates = await pres.getInfo();\n  const mySlides = myTemplates.slidesByTemplate(`myTemplate`);\n\n  // Feel free to create some functions to pre-define all modifications\n  // you need to apply to your slides.\n  type CallbackBySlideNumber = {\n    slideNumber: number;\n    callback: (slide: ISlide) => void;\n  };\n  const callbacks: CallbackBySlideNumber[] = [\n    {\n      slideNumber: 2,\n      callback: (slide: ISlide) => {\n        slide.modifyElement('Cloud', [\n          ModifyTextHelper.setText('My content'),\n          ModifyShapeHelper.setPosition({\n            h: CmToDxa(5),\n          }),\n          ModifyColorHelper.solidFill({\n            type: 'srgbClr',\n            value: 'cccccc',\n          }),\n        ]);\n      },\n    },\n  ];\n  const getCallbacks = (slideNumber: number) => {\n    return callbacks.find((callback) => callback.slideNumber === slideNumber)\n      ?.callback;\n  };\n\n  // We can loop all slides an apply the callbacks if defined\n  mySlides.forEach((mySlide) => {\n    pres.addSlide('myTemplate', mySlide.number, getCallbacks(mySlide.number));\n  });\n\n  // This will result to an output presentation containing all slides of \"SlideWithShapes.pptx\"\n  pres.write(`myOutputPresentation.pptx`).then((summary) => {\n    console.log(summary);\n  });\n};\n\nrun().catch((error) => {\n  console.error(error);\n});\n```\n\n## Quickly get all slide numbers of a template\n\nWhen calling `pres.getInfo()`, it will gather information about all elements on all slides of all templates. In case you just want to loop through all slides of a certain template, you can use this shortcut:\n\n```ts\nconst slideNumbers = await pres\n  .getTemplate('myTemplate.pptx')\n  .getAllSlideNumbers();\n\nfor (const slideNumber of slideNumbers) {\n  // do the thing\n}\n```\n\n## Find all text elements on a slide\n\nWhen processing an added slide, you might want to apply a modifier to any existing text element. Call `slide.getAllTextElementIds()` for this:\n\n```ts\nimport Automizer, { modify } from 'pptx-automizer';\n\npres.addSlide('myTemplate.pptx', 1, async (slide) => {\n  const elements = await slide.getAllTextElementIds();\n  elements.forEach((element) => {\n    // element has a text body:\n    slide.modifyElement(element, [modify.setText('my text')]);\n    // ... or use the tag replace function:\n    slide.modifyElement(element, [\n      modify.replaceText([\n        {\n          replace: 'TAG',\n          by: {\n            text: 'my tag text',\n          },\n        },\n      ]),\n    ]);\n  });\n});\n```\n\n## Sort output slides\n\nThere are three ways to arrange slides in an output presentation.\n\n1. By default, all slides will be appended to the existing slides in your root template. The order of `addSlide`-calls will define slide sortation in output presentation.\n\n2. You can alternatively remove all existing slides by setting the `removeExistingSlides` flag to true. The first slide added with `addSlide` will be first slide in the output presentation. If you want to insert slides from root template, you need to load it a second time.\n\n```ts\nimport Automizer from 'pptx-automizer';\n\nconst automizer = new Automizer({\n  templateDir: `my/pptx/templates`,\n  outputDir: `my/pptx/output`,\n\n  // truncate root presentation and start with zero slides\n  removeExistingSlides: true,\n});\n\nlet pres = automizer\n  .loadRoot(`RootTemplate.pptx`)\n  // We load this twice to make it available for sorting slide\n  .load(`RootTemplate.pptx`, 'root')\n  .load(`SlideWithShapes.pptx`, 'shapes')\n  .load(`SlideWithGraph.pptx`, 'graph');\n\npres\n  .addSlide('root', 1) // First slide will be taken from root\n  .addSlide('graph', 1)\n  .addSlide('shapes', 1)\n  .addSlide('root', 3) // Third slide from root will be appended\n  .addSlide('root', 2); // Second and third slide will switch position\n\npres.write(`mySortedPresentation.pptx`).then((summary) => {\n  console.log(summary);\n});\n```\n\n3. Use `sortSlides`-callback\n   You can pass an array of numbers and create a callback and apply it to `presentation.xml`.\n   This will also work without adding slides.\n\nSlides will be appended to the existing slides by slide number (starting from 1). You may find irritating results in case you skip a slide number.\n\n```ts\nimport ModifyPresentationHelper from './helper/modify-presentation-helper';\n\n//\n// You may truncate root template or you may not\n// ...\n\n// It is possible to skip adding slides, try sorting an unmodified presentation\npres\n  .addSlide('charts', 1)\n  .addSlide('charts', 2)\n  .addSlide('images', 1)\n  .addSlide('images', 2);\n\nconst order = [3, 2, 4, 1];\npres.modify(ModifyPresentationHelper.sortSlides(order));\n```\n\n## Import and modify slide Masters\n\nYou can import, modify and use one or more slideMasters and the related slideLayouts.\nIt is only supported to add and modify shapes on the underlying slideMaster, you cannot modify something on a slideLayout. This means, each modification on a slideMaster will appear on all related slideLayouts.\n\nTo specify the target index of the required slide master to import, you need to count slideMasters in your _template_ presentation.\nTo specify another slideLayout for an added output slide, you need to count slideLayouts in your _output_ presentation\n\nTo add and modify shapes on a slide master, please take a look at [Add and modify shapes](https://github.com/singerla/pptx-automizer#add-and-modify-shapes).\n\nIf you require to modify slide master backgrounds, please refer to \n- [Modify master background color](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-master-background-color.test.ts).\n- [Modify master background image](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-master-background-image.test.ts).\n\n```ts\n// Import another slide master and all its slide layouts.\n// Index 1 means, you want to import the first of all masters:\npres.addMaster('SlidesWithAdditionalMaster.pptx', 1, (master) => {\n  // Modify a certain shape on the slide master:\n  master.modifyElement(\n    `MasterRectangle`,\n    ModifyTextHelper.setText('my text on master'),\n  );\n  // Add a shape from an imported templated to the current slideMaster.\n  master.addElement('SlideWithShapes.pptx', 1, 'Cloud 1');\n});\n```\n\nAny imported slideMaster will be appended to the existing ones in the root template. If you have already e.g. one master with five layouts, and you import a new master coming with seven slide layouts, the first new layout will be #6.\n\n```ts\n// Import a slideMaster and its slideLayouts:\npres.addMaster('SlidesWithAdditionalMaster.pptx', 1);\n\n// Add a slide and switch to another layout:\npres.addSlide('SlidesWithAdditionalMaster.pptx', 3, (slide) => {\n  // use another master, e.g. the imported one from 'SlidesWithAdditionalMaster.pptx'\n  // You need to pass the index of the desired layout after all\n  // related layouts of all imported masters have been added to rootTemplate.\n  slide.useSlideLayout(12);\n});\n\n// It is also possible to use the original slideLayout of any added slide:\npres.addSlide('SlidesWithAdditionalMaster.pptx', 3, (slide) => {\n  // To use the original master from 'SlidesWithAdditionalMaster.pptx',\n  // we can skip the argument:\n  slide.useSlideLayout();\n  // This will also auto-import the original slideMaster, if not done already,\n  // and look for the created index of the source slideLayout.\n});\n```\n\nPlease notice: If your root template and your imported slides have an equal structure of slideMasters and slideLayouts, it won't be necessary to add slideMasters manually.\n\nIf you have trouble with messed up slideMasters, and if you don't worry about the impact on performance, you can try and set `autoImportSlideMasters: true` to always import all required files:\n\n```ts\nimport Automizer from 'pptx-automizer';\n\nconst automizer = new Automizer({\n  // ...\n\n  // Always use the original slideMaster and slideLayout of any\n  // imported slide:\n  autoImportSlideMasters: true,\n  // ...\n});\n```\n\n## Track status of automation process\n\nWhen creating large presentations, you might want to have some information about the current status. Use a custom status tracker:\n\n```ts\nimport Automizer, { StatusTracker } from 'pptx-automizer';\n\n// If you want to track the steps of creation process,\n// you can use a custom callback:\nconst myStatusTracker = (status: StatusTracker) => {\n  console.log(status.info + ' (' + status.share + '%)');\n};\n\nconst automizer = new Automizer({\n  // ...\n  statusTracker: myStatusTracker,\n});\n```\n\n## Create a new modifier\n\nIf the built-in modifiers of `pptx-automizer` are not sufficient to your task, you can access the target xml elements with [xmldom](https://github.com/xmldom/xmldom). A modifier is a wrapper for such an operation.\n\nLet's first take a look at a (simplified) existing modifier: `ModifyTextHelper.content('This is my text')`.\n\n```ts\n// \"setTextContent\" is a function that returns a function.\n// A \"label\" argument needs to be passed to \"setTextContent\".\nconst setTextContent = function (label: number | string) {\n  // On setup, we can handle the argument.\n  const newTextContent = String(label);\n\n  // A new function is returned to apply the label at runtime.\n  return function (shape: XmlElement) {\n    // \"shape\" contains a modifiable xmldom object.\n    // You can use a selector to find the required 'a:t' element:\n    const textElement = shape.getElementsByTagName('a:t').item(0);\n\n    // You can now apply the \"newTextContent\".\n    if (textElement?.firstChild) {\n      // Refer to xmldom for available functions.\n      textElement.firstChild.textContent = newTextContent;\n    }\n    // It is possible to output the xml to console at any time.\n    // XmlHelper.dump(element);\n  };\n};\n```\nThis function will construct an anonymous callback function on setup, while the callback function itself will be executed on runtime, when it's up to the target element on a slide.\n\nYou can use the modifier e.g. on adding an element:\n\n```ts\npres.addSlide('SlideWithShapes.pptx', 2, (slide) => {\n  // This will import the 'Drum' shape\n  slide.modifyElement('Cloud', [\n    // 1. Dump the original xml:\n    // Notice: don't call XmlHelper.dump, just pass it\n    XmlHelper.dump,\n    // 2. Apply modifier from the example above:\n    setTextContent('New text'),\n    XmlHelper.dump,\n  ]);\n});\n```\n\nWe can wrap any xml modification by such a modifier. If you have a working example and you think it will be useful to others, you are very welcome to fork this repo and send a pull request or simply [post it](https://github.com/singerla/pptx-automizer/issues/new).\n\n## More examples\n\nTake a look into [**tests**-directory](https://github.com/singerla/pptx-automizer/blob/main/__tests__) to see a lot of examples for several use cases, e.g.:\n\n- [Style chart series or datapoints](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-existing-chart-styled.test.ts)\n- [Use tags inside text to replace contents](https://github.com/singerla/pptx-automizer/blob/main/__tests__/replace-tagged-text.test.ts)\n- [Modify vertical line charts](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-vertical-lines.test.ts)\n- [Set table cell and border styles](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-existing-table.test.ts)\n- [Update chart plot area coordinates](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-plot-area.test.ts)\n- [Update chart legend](https://github.com/singerla/pptx-automizer/blob/main/__tests__/modify-chart-legend.test.ts)\n\n## Troubleshooting\n\nIf you encounter problems when opening a `.pptx`-file modified by this library, you might worry about PowerPoint not giving any details about the error. It can be hard to find the cause, but there are some things you can check:\n\n- **Broken relation**: There are still unsupported shape types and `pptx-automizer` wil not copy required relations of those. You can inflate `.pptx`-output and check `ppt/slides/_rels/slide[#].xml.rels`-files to find possible missing files.\n- **Unsupported media**: You can also take a look at the `ppt/media`-directory of an inflated `.pptx`-file. If you discover any unusual file formats, remove or replace the files by one of the [known types](https://github.com/singerla/pptx-automizer/blob/main/src/enums/content-type-map.ts).\n- **Broken animation**: Pay attention to modified/removed shapes which are part of an animation. In case of doubt, (temporarily) remove all animations from your template. (see [#78](https://github.com/singerla/pptx-automizer/issues/78))\n- **Proprietary/Binary contents** (e.g. ThinkCell): Walk through all slides, slideMasters and slideLayouts and seek for hidden Objects. Hit `ALT+F10` to toggle the sidebar.\n- **Chart styles not working**: If you try to change e.g. color or size of a chart data label, and it doesn't work as expected, try to remove all data labels and activate them again. If this does not help, try to give the first data label of a series a slightly different style (this creates a single data point).\n- **Replace Text not working**: Cut out your e.g. {CustomerName} tag from textbox to clipboard, paste it into a plaintext editor to remove all (visible and invisible) formatting. Copy & paste {CustomerName} back to the textbox. (see [#82](https://github.com/singerla/pptx-automizer/issues/82) and [#73](https://github.com/singerla/pptx-automizer/issues/73))\n\n\nIf none of these could help, please don't hesitate to [talk about it](https://github.com/singerla/pptx-automizer/issues/new). \n\n## Testing\n\nYou can run all unit tests using these commands:\n\n```\nyarn test\nyarn test-coverage\n```\n\n# Special Thanks\n\nThis project was inspired by:\n\n- [PptxGenJS](https://github.com/gitbrent/PptxGenJS)\n- [officegen](https://github.com/Ziv-Barber/officegen)\n- [node-pptx](https://github.com/heavysixer/node-pptx)\n- [docxtemplater](https://github.com/open-xml-templating/docxtemplater)\n",
    "licenseText": "MIT License\n\nCopyright (c) 2021 Thomas Singer\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/pptx-automizer/-/pptx-automizer-0.4.8.tgz#cc4c5336f9771a576867d6a8d9b4564b8a5327ad",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/pptx-automizer/-/pptx-automizer-0.4.8.tgz",
    "hash": "cc4c5336f9771a576867d6a8d9b4564b8a5327ad",
    "integrity": "sha512-TvK2diiVYAp4MpVuoWvKD5+VPxcZiup+ht86RPj1gMlF1+0eYQrwntaZThSi7c1RXYm6o02DWg61PaeTSeGVIA==",
    "registry": "npm",
    "packageName": "pptx-automizer",
    "cacheIntegrity": "sha512-TvK2diiVYAp4MpVuoWvKD5+VPxcZiup+ht86RPj1gMlF1+0eYQrwntaZThSi7c1RXYm6o02DWg61PaeTSeGVIA== sha1-zExTNvl3GldoZ9ao2bRWS4pTJ60="
  },
  "registry": "npm",
  "hash": "cc4c5336f9771a576867d6a8d9b4564b8a5327ad"
}